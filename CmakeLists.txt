cmake_minimum_required(VERSION 2.8)

project(base)

#项目全局变量
set(CMAKE_CXX_COMPILER "g++")
set(CMAKE_CXX_FLAGS "-Wall")
set(CMAKE_CXX_FLAGS_DEBUG "-g3")
set(CMAKE_CXX_FLAGS_RELEASE "-O2")
set(EXECUTABLE_OUTPUT_PATH ${PROJECT_SOURCE_DIR}/bin)
set(LIBRARY_OUTPUT_PATH ${PROJECT_SOURCE_DIR}/lib)

#指定库路径
link_directories(${LIBRARY_OUTPUT_PATH})

#base库
aux_source_directory(${PROJECT_SOURCE_DIR}/src/kernel/base BASE_LIB_SRC)
add_library(base STATIC ${BASE_LIB_SRC})

#可执行文件
aux_source_directory(${PROJECT_SOURCE_DIR}/src SRC_LIST)
include_directories(${PROJECT_SOURCE_DIR}/src/kernel)
include_directories(${PROJECT_SOURCE_DIR}/src/kernel/base)

#生成最终文件
if(${CMAKE_BUILD_TYPE} MATCHES "debug")
    add_executable(virtualComputer-debug ${SRC_LIST})
    target_link_libraries(virtualComputer-debug base)
    add_executable(asm-debug tool/asm.cpp)
    target_link_libraries(asm-debug base)
else()
    add_executable(virtualComputer ${SRC_LIST})
    target_link_libraries(virtualComputer base)
    add_executable(asm tool/asm.cpp)
    target_link_libraries(asm base)
endif()